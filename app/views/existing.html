<div ng-controller="EditController">
  <h2>Existing Requests <i ng-show="loading" class="fa fa-refresh fa-pulse"></i> </h2>

  <div class="list-group">
    <div class="list-group-item" ng-repeat="request in requests">

      <div>
        <div>
          <h4><a href="javascript:void(0);" ng-click="show(request)">{{ request.name }}</a></h4>
          <h5>{{ request.date | date : 'yyyy' }}</h5>
        </div>

        <div>
          <button class="btn btn-primary" ng-click="deleteRequest(request)">Mark Complete</button>
          <button class="btn btn-default" ng-click="deleteRequest(request)">Delete</button>
        </div>
      </div><br/>

      <div ng-if="request.comments.length">
        <div class="row" ng-repeat="comment in request.comments">
          <div class="col-sm-10">{{ comment.content }}</div>
          <div class="col-sm-2">
            <a href="javascript:void(0)" class="text-muted pull-right" ng-click="deleteComment(request, comment)">Remove</a>
          </div>
        </div><br/>
      </div>

      <div>
        <a ng-if="!showingCommentBox(request)" href="javascript:void(0)" class="text-muted []" ng-click="showCommentBox(request)">+ Write a comment...</a>
      </div>

      <div ng-if="showingCommentBox(request)" class="input-group">
        <input class="form-control" type="text" placeholder="Write a comment..."
          ng-model="newComment"
          ng-keypress="addCommentIfEnterKeyPressed($event, request, newComment)"/>
        <span class="input-group-btn">
          <button class="btn btn-primary" ng-click="addComment(request, newComment)">+</button>
        </span>
      </div><br/>

    </a>
  </div>
</div>
